<!DOCTYPE html>
<html lang="en">
	<head>
		<title>three.js webgl - effects - ascii</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link type="text/css" rel="stylesheet" href="main.css">
	</head>

	<body>
		<!-- Import maps polyfill -->
		<!-- Remove this when import maps will be widely supported -->
		<script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>

		<script type="importmap">
			{
				"imports": {
					"three": "./js/three.module.js"
				}
			}
		</script>

		<script type="module">

			import * as THREE from 'three';

			import { AsciiEffect } from './js/AsciiEffect.js';
			import { TrackballControls } from './js/TrackballControls.js';

			let camera, controls, scene, renderer, effect;

			let sphere, plane;

			const start = Date.now();

			init();
			animate();

			function init() {

				camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 1, 1000 );
				camera.position.y = 150;
				camera.position.z = 500;

				scene = new THREE.Scene();
				scene.background = new THREE.Color( 0, 0, 0 );

				const pointLight1 = new THREE.PointLight( 0xffffff );
				pointLight1.position.set( 500, 500, 500 );
				scene.add( pointLight1 );

				const pointLight2 = new THREE.PointLight( 0xffffff, 0.25 );
				pointLight2.position.set( - 500, - 500, - 500 );
				scene.add( pointLight2 );

				sphere = new THREE.Mesh( new THREE.SphereGeometry( 200, 20, 10 ), new THREE.MeshPhongMaterial( { flatShading: true } ) );
				scene.add( sphere );

				// Plane

				plane = new THREE.Mesh( new THREE.PlaneGeometry( 400, 400 ), new THREE.MeshBasicMaterial( { color: 0xe0e0e0 } ) );
				plane.position.y = - 200;
				plane.rotation.x = - Math.PI / 2;
				scene.add( plane );

				renderer = new THREE.WebGLRenderer();
				renderer.setSize( window.innerWidth, window.innerHeight );
				
				var kanji = "一人入力二十八七九刀丁大上下子小口山三女土工士万川丸千夕亡干久己才寸弓手日中不引分水切心文内方公化月天木火止反元今予戸支少王区円片父五太欠友仏夫毛比牛氏六午犬尺仁出生立本付目外主用代打民正白世平半仕石市加収失末古北母台申圧四可未広庁弁布示必田処写号辺礼句去旧左刊他玉由司右令史札包以皮冬犯幼兄永氷功矢穴冊皿央合気行地会年自名当同先回成有全交色向死安任次団共多休好字早伝式在再曲老血両光肉西列米守百印存仮争件考仲衣吸毎各宅因羽虫灯危至耳糸州寺竹宇池舌灰兆羊后机見体言作身売社来車決何利足別形対返役初投近花局冷労私防声図応位住医角乱告余状走判改兵助低男折良町芸技児条赤完快否材我系求村究似束災弟囲序均志卵里君豆麦忘希困谷臣批孝貝努坂汽物学国取的事金者所実長定法性明直空受知和画表味官制夜放治苦命門店使居価雨念具例参東並歩育果青始服呼波非板林油固若券延版注効協底刻英委典河岸武供府周宝乳担易季毒京岩松舎届往承妻幸泣宙肥卒宗沿拡枚述牧垂拝忠刷泳招芽枝姉昔径妹前発食面重後風度点持海乗相品政神信思変保屋音送軍科指追計急退要飛室独草界限待南洋美活段約負客首巻建便派専省逆洗春茶単査星型栄背厚県昨故映係級染研則秋祖昼祝革奏紅皇砂城律迷紀炭看勇宣畑姿柱拾浅泉胃秒肺昭書家通高時流原員真連差特配病記消起格校料素紙党根速能院留残害造座案値容破殺帰降修師弱挙馬酒席航帯骨息射除財納夏借旅益個従笑宮将荷島梅庭純秘庫株脈展浴討候粉訓徒恩針倍胸孫倉勉朗耕桜俳俵班郡陛蚕理動産部務教転強悪情断経野進組寄問張現得常船球商終細密盛視異望接都黒設率習深術側婦移済敗基訳陸雪規族宿鳥閉第混険週票欲眼健祭略推清著魚採脳探域責救副授堂停許捨貧章黄貨液訪唱郷頂菜帳郵窓翌巣康械笛無間道場着期落開最割過集量報結勝運然焼税費買減葉番絶朝検証営覚満装散軽裁給等温備達復象短評筆程順統遊歯絵補隊痛答貸策飲植善勤登筋景悲衆提晴創属街貴飯寒階陽港富晩測喜敬博棒雲詞就湯尊童暑貯賀揮湖森貿業戦意数新電感義話解楽極路愛続勢農試置遠資想傷鉄裏園禁働節辞幕準暗源損腹照群罪塩詩福預漢聖賃暖鉱夢墓幹署蒸豊盟誠腸飼絹語総関算読増歌様演製精際種説管聞適領雑銀態認察境疑静構障像誤歴暮酸慣模漁閣練複層旗鳴駅緑誌徳鼻磁銅綿銭穀調論線権器質選熱横養確談劇遺暴輪賞編導蔵敵標課熟賛潮潔箱諸億誕機頭親積薬衛館録激興整樹燃輸橋築縦操憲奮鋼糖優厳縮講謝覧績難職観題顔類験額曜織臨簡識警願鏡臓議護競";

				effect = new AsciiEffect( renderer, kanji, { invert: true } );
				effect.setSize( window.innerWidth, window.innerHeight );
				effect.domElement.style.color = 'white';
				effect.domElement.style.backgroundColor = 'black';

				// Special case: append effect.domElement, instead of renderer.domElement.
				// AsciiEffect creates a custom domElement (a div container) where the ASCII elements are placed.

				document.body.appendChild( effect.domElement );

				controls = new TrackballControls( camera, effect.domElement );

				//

				window.addEventListener( 'resize', onWindowResize );

			}

			function onWindowResize() {

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );
				effect.setSize( window.innerWidth, window.innerHeight );

			}

			//

			function animate() {

				requestAnimationFrame( animate );

				render();

			}

			function render() {

				const timer = Date.now() - start;

				sphere.position.y = Math.abs( Math.sin( timer * 0.002 ) ) * 150;
				sphere.rotation.x = timer * 0.0003;
				sphere.rotation.z = timer * 0.0002;

				controls.update();

				effect.render( scene, camera );

			}

		</script>

	</body>
</html>
